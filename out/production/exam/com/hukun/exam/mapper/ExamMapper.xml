<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hukun.exam.mapper.ExamMapper">


    <select id="getExamList" parameterType="hashmap" resultMap="examMap">
        select e.id as eid,
        e.examName,
        e.examDecript,
        e.classid,
        e.categary,
        e.publish,
        e.teacherId,
        e.publishTime,
        e.examStauts,
        u.nickname,
        u.rightid,
        u.id as uid,
        r.rightName
        from exam as e
        inner join user as u on u.id = e.teacherId
        left join `right` as r on u.rightid = r.id
        where u.rightid = 1
        <where>
            <if test="examName!=null and examName!=''">
                and examName like '%${examName}%'
            </if>
        </where>
        limit #{pageStart}, #{pageSize}
    </select>


    <resultMap id="examMap" type="ExamUser">

        <id property="id" column="eid"></id>
        <result property="examName" column="examName"></result>
        <result property="examDecript" column="examDecript"></result>
        <result property="classid" column="classid"></result>
        <result property="categary" column="categary"></result>
        <result property="publish" column="publish"></result>
        <result property="teacherId" column="teacherId"></result>
        <result property="publishTime" column="publishTime"></result>
        <result property="examStauts" column="examStauts"></result>

        <association property="user" javaType="user">
            <id property="id" column="uid"></id>
            <result property="nickname" column="nickname"></result>

        </association>

    </resultMap>

    <insert id="insertExam" parameterType="Exam">
         insert exam values (#{id},
         #{examName},
         #{examDecript},
         #{classid},

         #{categary},
           #{publish},
         #{teacherId},
         #{publishTime},
         #{examStauts})
    </insert>

    <insert id="insertPaper" parameterType="paper">
         insert paper values (#{id},#{examid},#{title},#{options_},#{answer})
    </insert>
</mapper>